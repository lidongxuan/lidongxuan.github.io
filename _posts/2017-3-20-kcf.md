---
layout: post
title: 目标跟踪：KCF
comments: false
---

<!--more-->

KCF是João F. Henriques的论文High-Speed Tracking with Kernelized Correlation Filters提出的一种目标跟踪算法。

KCF，由目标区域形成循环矩阵，再利用循环矩阵在傅立叶空间可对角化等一些性质，通过岭回归得到通用的预测公式，特别要说一点就是该预测公式没有矩阵求逆的计算，这都归功于作者巧妙地将循环矩阵在傅立叶空间的性质与目标跟踪时循环采样相结合，大大减少的计算量。

KCF的论文中分别实验了三种情形的岭回归，分别是普通线性岭回归、多项式岭回归、核空间下的岭回归。前两种不必多说，最后一种核空间，大家可以回忆一下SVM将低维空间映射到高维空间的方法，当然在KCF里由于要利用循环矩阵的性质，所以这里的核矩阵是循环矩阵（必为方阵）。

KCF里的输出是一个二维response矩阵，里面元素的大小代表该位置下的目标为预测目标的可能性，因此，在训练的时候就是输入是特征，而输出是一个gaussian_shaped_label，一般分类的标签是二值的，或者多值离散的，但是这个高斯标签反应的是由初始目标移位采样形成的若干样本距离初识样本越近可能性越大的准则，在代码中，高斯的峰值被移动到了左上角（于是四个角的值偏大），原因是“after computing a cross-correlation between two images in the Fourier domain and converting back to the spatial domain, it is the top-left element of the result that corresponds to a shift of zero”，也就是说目标零位移对应的是左上角的值。这样一来，我们在预测目标位置的时候，只需要pos=pos+find(response==max(response(:)))就好。

在学习KCF的过程中我一开始由于理解不透彻有个疑问，由于我是代码和论文以及博客结合起来看的，发现论文里提及的循环采样在代码里根本没有体现。too young，其实KCF做的就是将循环矩阵在傅立叶空间的性质与图像中目标的循环移位采样结合，做出一系列的推导最终得出少数一般性的公式，这样在编程的时候直接用一般性公式就好，大大减少计算量，加快跟踪速度。

KCF跟踪算法是目标跟踪阶段中的目标搜索部分，因此目标特征表达可以有很多种选择，作者在论文用的是HOG，还有一些学者用了CNN之类的。

关于KCF除了原论文还有一个很好的参考资料，是一篇[博客](http://www.cnblogs.com/YiXiaoZhou/p/5925019.html)，写得很详细易懂。

##参考资料##

[KCF目标跟踪方法分析与总结](http://www.cnblogs.com/YiXiaoZhou/p/5925019.html)

[【目标跟踪】KCF高速跟踪详解](http://blog.csdn.net/shenxiaolu1984/article/details/50905283)

[Kernelized Correlation Filters(KCF)算法](http://www.360doc.com/content/16/0302/13/25664332_538789414.shtml)